{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "BedrockCore",
      "Effect": "Allow",
      "Action": [
        "bedrock:InvokeModel",
        "bedrock:InvokeModelWithResponseStream",
        "bedrock:List*",
        "bedrock:Get*",
        "bedrock:Retrieve",
        "bedrock:RetrieveAndGenerate"
      ],
      "Resource": "*"
    },
    {
      "Sid": "BedrockManage",
      "Effect": "Allow",
      "Action": [
        "bedrock:Create*",
        "bedrock:Update*",
        "bedrock:Delete*",
        "bedrock:PrepareAgent",
        "bedrock:InvokeAgent",
        "bedrock:Associate*",
        "bedrock:Disassociate*",
        "bedrock:ApplyGuardrail"
      ],
      "Resource": "*"
    },
    {
      "Sid": "AgentCoreAll",
      "Effect": "Allow",
      "Action": "bedrock-agentcore:*",
      "Resource": "*"
    },
    {
      "Sid": "IAMPassRole",
      "Effect": "Allow",
      "Action": "iam:PassRole",
      "Resource": [
        "arn:aws:iam::*:role/AmazonBedrockAgentCore*",
        "arn:aws:iam::*:role/*BedrockAgentCore*",
        "arn:aws:iam::*:role/service-role/AmazonBedrockAgentCore*"
      ],
      "Condition": {
        "StringEquals": {
          "iam:PassedToService": ["bedrock.amazonaws.com", "bedrock-agentcore.amazonaws.com"]
        }
      }
    },
    {
      "Sid": "IAMServiceLinked",
      "Effect": "Allow",
      "Action": "iam:CreateServiceLinkedRole",
      "Resource": "arn:aws:iam::*:role/aws-service-role/*",
      "Condition": {
        "StringLike": {
          "iam:AWSServiceName": "bedrock*.amazonaws.com"
        }
      }
    },
    {
      "Sid": "ECR",
      "Effect": "Allow",
      "Action": "ecr:GetAuthorizationToken",
      "Resource": "*"
    },
    {
      "Sid": "ECRRepo",
      "Effect": "Allow",
      "Action": ["ecr:Create*", "ecr:Describe*", "ecr:List*", "ecr:BatchGet*", "ecr:BatchCheck*", "ecr:Get*", "ecr:Put*", "ecr:InitiateLayerUpload", "ecr:UploadLayerPart", "ecr:CompleteLayerUpload"],
      "Resource": "arn:aws:ecr:*:*:repository/bedrock-agentcore-*"
    },
    {
      "Sid": "S3",
      "Effect": "Allow",
      "Action": ["s3:GetObject", "s3:PutObject", "s3:DeleteObject", "s3:ListBucket", "s3:GetBucketLocation", "s3:CreateBucket", "s3:PutLifecycleConfiguration"],
      "Resource": ["arn:aws:s3:::bedrock-agentcore-*", "arn:aws:s3:::bedrock-agentcore-*/*"]
    },
    {
      "Sid": "Logs",
      "Effect": "Allow",
      "Action": ["logs:CreateLogGroup", "logs:CreateLogStream", "logs:PutLogEvents", "logs:Describe*", "logs:GetLogEvents"],
      "Resource": ["arn:aws:logs:*:*:log-group:/aws/bedrock/*", "arn:aws:logs:*:*:log-group:/aws/bedrock-agentcore/*"]
    },
    {
      "Sid": "Secrets",
      "Effect": "Allow",
      "Action": ["secretsmanager:CreateSecret", "secretsmanager:UpdateSecret", "secretsmanager:GetSecretValue", "secretsmanager:DeleteSecret", "secretsmanager:DescribeSecret"],
      "Resource": "arn:aws:secretsmanager:*:*:secret:bedrock-agentcore-*"
    }
  ]
}
